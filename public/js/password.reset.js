var utility={getURLParam:function(e){var t=window.location.href;e=e.replace(/[\[\]]/g,"\\$&");var o=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),a=o.exec(t);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null},getTimeFromMinutes:function(e){var t=e/60,e=e%60,o=moment({hours:t,minutes:e});return o.format("hh:mm A")},getAlerts:function(e,t,o,a){$(".pms-alerts").remove();var r=$('<div  id = "'+o+'" class=" alert '+t+' pms-alerts alert-dismissible doc-profile-before-submit-warning-error" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>'+e+"</div>");$(a).prepend(r),console.log("alert created")},removeAlerts:function(){$(".pms-alerts").remove()}},links={authenticateUrl:"index.php/authenticate/authenitcateUser",successRedirectUrl:"index.php/doctorDashboard/",registerDoctorUrl:"index.php/doctor/doctorInfo",adminUrl:"index.php/adminDashboard/admin",passwordRestRequestUrl:"index.php/authenticate/resetPasswordRequest",loginUrl:"index.php/authenticate/login",passwordResetUrl:"index.php/authenticate/passwordReset",forgotPasswordUrl:"index.php/authenticate/forgotPassword",doctorListingUrl:"index.php/adminDashboard/doctorListing",getAllDoctorsUrl:"index.php/adminDashboard/getAllDoctors",adminDoctorEditRedirect:"index.php/adminDashboard/adminDoctorEdit",logoutUrl:"index.php/authenticate/logout",doctorProfile:"index.php/doctorDashboard/doctorProfile",dashboardHomeUrl:"index.php/doctorDashboard/",newAppointmentUrl:"index.php/doctorDashboard/bookAppointment",patientsEntryUrl:"index.php/doctorDashboard/patientsEntry",patientsListingUrl:"index.php/doctorDashboard/patientsListing",closeAppointmentUrl:"index.php/doctorDashboard/closeAppointment",doctorsAppointmentsListUrl:"index.php/doctorDashboard/listAppointment",newScheduleUrl:"index.php/doctorDashboard/newSchedule",deactivateScheduleUrl:"index.php/doctorDashboard/deactivateSchedule",listScheduleUrl:"index.php/doctorDashboard/scheduleList",getScheduleCalendarUrl:"index.php/doctorDashboard/ScheduleCalenderView",addStaffUrl:"index.php/doctorDashboard/staffEntry",doctorsStaffListingUr:"index.php/doctorDashboard/staffListing",patientsHistoryUrl:"index.php/doctorDashboard/patientHistory",createProgramForPatientUrl:"index.php/doctorDashboard/createMedicalProgram",programmeListingsUrl:"index.php/doctorDashboard/programmeList",ManageLocationsUrl:"index.php/doctorDashboard/workLocationManagement",getAnalyticsUrl:"index.php/doctorDashboard/AnalyticsReport",getCalenderUrl:"index.php/doctorDashboard/calendarTemplate",accountingUrl:"index.php/doctorDashboard/accounting",medicineSearchUrl:"index.php/doctorDashboard/medicineSearch",getLocationUrl:"index.php/locations/getDoctorLocations",createUpdateScheduleUrl:"index.php/schedule/createUpdateSchedule",getSechduleCalendarDetailsUrl:"index.php/schedule/getCalanderDetails",getSechduleforDeactivation:"index.php/schedule/getSchedulesForDeactivation",deactivateScheduleDays:"index.php/schedule/deactivateScheduleDays",doctorsProgramsUrl:"index.php/programme/getDoctorsCheckupPrograms",programmeEditUrl:"index.php/doctorDashboard/createMedicalProgram",createModifyProgrammeUrl:"index.php/programme/createModifyProgramme",getProgrammeUrl:"index.php/programme/getProgrammes",patientDetailPersistUrl:"index.php/patient/addUpdatePatient",patientsDetailsUrl:"index.php/patient/getPatientDetails",loginCheckUrl:"index.php/authenticate/isLoggedIn",getProgrammeList:"index.php/programme/getMedicationProgrammeList",programmeListDetailsUrl:"index.php/programme/getProgrammeListDetails",patientListingUrl:"index.php/patient/getPatientList",getPatientsForAutoFillUrl:"index.php/patient/getPatientListForAutoFill",getPatientHistoryUrl:"index.php/patient/getPatientHistory",getpatientsImageUrl:"index.php/patient/getPatientImage",bookAppointmentUrl:"index.php/appointment/bookAppointment",getAppointmentForTheDayUrl:"index.php/appointment/getAppointmentsForTheDay",getAllAppointmentsUrl:"index.php/appointment/getAllAppointments",cancelAppointmentUrl:"index.php/appointment/cancelAppointment",closeAppointmentUrl:"index.php/appointment/closeAppointment",rescheduleAppointmentUrl:"index.php/appointment/rescheduleAppointment",saveUpdateLocations:"index.php/locations/addUpdateLocation",locationListUrl:"index.php/locations/getDoctorLocations",deactivateLocationUrl:"index.php/locations/deactivateLocation",deliveryMethodsUrl:"index.php/patient/getDeliveryMethods",doctorUrl:"index.php/doctor/saveUpdateDoctor",doctorDetailsUrl:"index.php/doctor/getDoctorDetails",loginCheckUrl:"index.php/authenticate/isLoggedIn",doctorDashUrl:"index.php/doctorDashboard/",logoutUrl:"index.php/authenticate/logout",createModifyStaffUrl:"index.php/staff/createModifyStaff",getStaffDetailsUrl:"index.php/staff/getStaffDetails",staffListingUrl:"index.php/staff/getDoctorsStaffList",closeApptUploadFiles:"index.php/Upload/CloseApptUpload",PatientUploadimage:"index.php/Upload/PatientImageUpload",GaurdianUploadimage:"index.php/Upload/GuardianImageUpload"};$(document).ready(function(){$(function(){console.log("forgot password js loaded");var e={resetCode:""},t={init:function(){this.passwordResetUrl=links.passwordResetUrl,this.doctorDashboardUrl=links.dashboardHomeUrl,this.forgotPasswordUrl=links.forgotPasswordUrl;var t=utility.getURLParam("code");t&&(e.resetCode=t,o.init())},resetPassword:function(a){code=e.resetCode,$.post(t.passwordResetUrl,{password:a,resetCode:code}).done(function(e){if(console.log("respose "+JSON.stringify(e)),0==e.status){console.log("success");var a=e.data;"D"==a.type?(console.log("redirect to doc"),window.location.href=t.doctorDashboardUrl):"S"==a.type&&console.log("redirect to staff")}else 2==e.status&&(console.log("reset code is not valid"),o.alertResetCodeInvalid.removeClass("hidden"))})}},o={init:function(){this.txtPassword=$("#txt-password"),this.txtConfirmPassword=$("#txt-confirm-password"),this.btnResetPassword=$("#btn-reset-password"),this.linkForgotPassword=$("#link-forgot-password"),this.alertPassNeeded=$("#alert-password-needed"),this.alertConfirmPassNeeded=$("#alert-confirm-password-needed"),this.alertMatchingValidation=$("#alert-password-not-matching"),this.alertInfo=$("#alert-info"),this.alertResetCodeInvalid=$("#alert-reset-code-invalid"),console.log("init view"),this.linkForgotPassword.attr("href",t.forgotPasswordUrl),this.btnResetPassword.click(function(){o.hideAllAlerts();var e=o.txtPassword.val(),a=o.txtConfirmPassword.val();return console.log("pass"+e+" confirm "+a),e&&e.trim()?a&&a.trim()?e!=a?(console.log("matching"),void o.alertMatchingValidation.removeClass("hidden")):void t.resetPassword(e):(console.log("confirm pass"),void o.alertConfirmPassNeeded.removeClass("hidden")):(console.log("pass"),void o.alertPassNeeded.removeClass("hidden"))})},hideAllAlerts:function(){this.alertPassNeeded.addClass("hidden"),this.alertConfirmPassNeeded.addClass("hidden"),this.alertMatchingValidation.addClass("hidden"),this.alertInfo.addClass("hidden"),this.alertResetCodeInvalid.addClass("hidden")}};t.init()}())});